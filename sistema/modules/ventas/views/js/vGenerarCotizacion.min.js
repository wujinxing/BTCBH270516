var vGenerarCotizacion_=function(){var c,d;c=0;d="";this.publico={};this.publico.main=function(a){simpleScript.addTab({id:diccionario.tabs.VCOTI,label:$(a).attr("title"),fnCallback:function(){d=$(a).data("sitemap");vGenerarCotizacion.getContenido()}})};this.publico.getContenido=function(){simpleAjax.send({dataType:"html",root:"ventas/generarCotizacion/",data:"&_siteMap="+d,fnCallback:function(a){$("#"+diccionario.tabs.VCOTI+"_CONTAINER").html(a);vGenerarCotizacion.getGridVGenerarCotizacion()}})}; this.publico.getGridVGenerarCotizacion=function(){var a=$("#"+diccionario.tabs.VCOTI+"gridVGenerarCotizacion").dataTable({bProcessing:!0,bServerSide:!0,bDestroy:!0,sPaginationType:"bootstrap_full",sServerMethod:"POST",bPaginate:!0,iDisplayLength:10,aoColumns:[{sTitle:lang.generico.CODIGO,sWidth:"11%"},{sTitle:lang.generico.CLIENTE,sWidth:"30%"},{sTitle:lang.generico.FECHA,sWidth:"12%",sClass:"center"},{sTitle:lang.generico.TOTAL,sWidth:"15%",sClass:"right"},{sTitle:lang.generico.ESTADO,sWidth:"15%", sClass:"center"},{sTitle:lang.generico.ACCIONES,sWidth:"18%",sClass:"center",bSortable:!1}],aaSorting:[[0,"desc"]],sScrollY:"350px",sAjaxSource:"ventas/generarCotizacion/getGridGenerarCotizacion",fnDrawCallback:function(){$("#"+diccionario.tabs.VCOTI+"gridVGenerarCotizacion_filter").find("input").attr("placeholder",lang.busqueda.VCOTI).css("width","400px");simpleScript.enterSearch("#"+diccionario.tabs.VCOTI+"gridVGenerarCotizacion",a);simpleScript.removeAttr.click({container:"#widget_"+diccionario.tabs.VCOTI, typeElement:"button"})}});setup_widgets_desktop()};this.publico.getFormBuscarProductos=function(a,b){simpleAjax.send({element:a,dataType:"html",root:"ventas/generarCotizacion/getFormBuscarProductos",fnCallback:function(a){$("#cont-modal").append(a);$("#"+diccionario.tabs.VCOTI+"formBuscarProductos").modal("show")}})};this.publico.getFormNewVGenerarCotizacion=function(a){0<$("#"+diccionario.tabs.VCOTI+"new_CONTAINER").length?simpleScript.notify.warning({content:"La pesta\u00f1a de Nueva o Clonar Cotizaci\u00f3n se encuentra abierta, debe cerrarla para realizar este proceso."}): (vGenerarCotizacionScript.resetArrayProducto(),simpleScript.addTab({id:diccionario.tabs.VCOTI+"new",label:"Nueva Cotizaci\u00f3n",fnCallback:function(){vGenerarCotizacion.getContGenerarCotizacion(a)}}))};this.publico.getContGenerarCotizacion=function(a){simpleAjax.send({element:a,dataType:"html",root:"ventas/generarCotizacion/getFormNewVGenerarCotizacion",fnCallback:function(a){$("#"+diccionario.tabs.VCOTI+"new_CONTAINER").html(a)}})};this.publico.getClonarCotizacion=function(a,b){c=b;0<$("#"+diccionario.tabs.VCOTI+ "new_CONTAINER").length?simpleScript.notify.warning({content:"La pesta\u00f1a de Nueva o Clonar Cotizaci\u00f3n se encuentra abierta, debe cerrarla para realizar este proceso."}):simpleScript.addTab({id:diccionario.tabs.VCOTI+"new",label:"Clonar Cotizaci\u00f3n",fnCallback:function(){vGenerarCotizacion.getContClonar(a);vGenerarCotizacionScript.resetArrayProducto()}})};this.publico.getContClonar=function(a){simpleAjax.send({element:a,dataType:"html",root:"ventas/generarCotizacion/getFormClonarCotizacion", data:"&_idCotizacion="+c,fnCallback:function(a){$("#"+diccionario.tabs.VCOTI+"new_CONTAINER").html(a)}})};this.publico.getContGenerar=function(){simpleAjax.send({dataType:"html",root:"ventas/generarCotizacion/getFormGenerarVenta",data:"&_idCotizacion="+c,fnCallback:function(a){$("#"+diccionario.tabs.VCOTI+"edit_CONTAINER").html(a)}})};this.publico.getFormViewDocumentos=function(a,b){c=b;simpleAjax.send({element:a,dataType:"html",root:"ventas/generarCotizacion/getFormViewDocumentos",data:"&_idCotizacion="+ c,fnCallback:function(a){$("#cont-modal").append(a);$("#"+diccionario.tabs.VCOTI+"formViewDocumentos").modal("show")}})};this.publico.postNewVGenerarCotizacion=function(a){simpleAjax.send({flag:a,element:"#"+diccionario.tabs.VCOTI+"btnGrCotizacion",root:"ventas/generarCotizacion/postNewGenerarCotizacion",form:"#"+diccionario.tabs.VCOTI+"formNewGenerarCotizacion, #"+diccionario.tabs.VCOTI+"formClonarGenerarCotizacion",data:"&_idCotizacion="+c,fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)|| simpleScript.notify.ok({content:lang.mensajes.MSG_3,callback:function(){simpleScript.closeTab(diccionario.tabs.VCOTI+"new");simpleScript.reloadGrid("#"+diccionario.tabs.VCOTI+"gridVGenerarCotizacion");c=0}})}})};this.publico.postPDF=function(a,b){simpleAjax.send({element:a,root:"ventas/generarCotizacion/postPDF",data:"&_idCotizacion="+b,fnCallback:function(a){1===parseInt(a.result)&&($("#"+diccionario.tabs.VCOTI+"btnDowPDF").off("click"),$("#"+diccionario.tabs.VCOTI+"btnDowPDF").attr("onclick","window.open('public/files/"+ a.archivo+"','_blank');"),$("#"+diccionario.tabs.VCOTI+"btnDowPDF").click())}})};this.publico.postPDFCarta=function(a,b){simpleAjax.send({element:a,root:"ventas/generarCotizacion/postPDFCarta",data:"&_idCotizacion="+b,fnCallback:function(a){1===parseInt(a.result)&&($("#"+diccionario.tabs.VCOTI+"btnDowPDF").off("click"),$("#"+diccionario.tabs.VCOTI+"btnDowPDF").attr("onclick","window.open('public/files/"+a.archivo+"','_blank');"),$("#"+diccionario.tabs.VCOTI+"btnDowPDF").click())}})};this.publico.postExcel= function(a,b){simpleAjax.send({element:a,root:"ventas/generarCotizacion/postExcel",data:"&_idCotizacion="+b,fnCallback:function(a){1===parseInt(a.result)&&($("#"+diccionario.tabs.VCOTI+"btnDowExcel").off("click"),$("#"+diccionario.tabs.VCOTI+"btnDowExcel").attr("onclick","window.open('public/files/"+a.archivo+"','_self');globalScript.deleteArchivo('"+a.archivo+"');"),$("#"+diccionario.tabs.VCOTI+"btnDowExcel").click());isNaN(a.result)||2!==parseInt(a.result)||simpleScript.notify.error({content:"Ocurri\u00f3 un error al exportar Venta."})}})}; this.publico.postAnularVGenerarCotizacion=function(a,b){simpleScript.notify.confirm({content:lang.mensajes.MSG_13,callbackSI:function(){simpleAjax.send({element:a,data:"&_idCotizacion="+b,root:"ventas/generarCotizacion/postAnularGenerarCotizacion",fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)||simpleScript.notify.ok({content:lang.mensajes.MSG_17,callback:function(){simpleScript.reloadGrid("#"+diccionario.tabs.VCOTI+"gridVGenerarCotizacion")}})}})}})};this.publico.getMensaje=function(a, b,c,e,d){simpleAjax.send({element:a,dataType:"html",root:"ventas/generarCotizacion/getViewMensaje",data:"&_nombres="+c+"&_idCotizacion="+b+"&_mail="+e+"&_vendedor="+d,fnCallback:function(a){$("#cont-modal").append(a);$("#"+diccionario.tabs.T4+"formViewMensaje").modal("show")}})};this.publico.postEmail=function(a,b,c){simpleAjax.send({element:"#"+diccionario.tabs.T4+"btnGrMensaje",form:"#"+diccionario.tabs.T4+"formViewMensaje",root:"ventas/generarCotizacion/postEmail",data:"&_nombres="+b+"&_idCotizacion="+ a+"&_mail="+c,fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)?isNaN(a.result)||2!==parseInt(a.result)||simpleScript.notify.error({content:"Ocurri\u00f3 un error con el env\u00edo de la cotizaci\u00f3n."}):(simpleScript.notify.ok({content:"Cotizaci\u00f3n se envi\u00f3 correctamente."}),globalScript.deleteArchivo(a.coti),globalScript.deleteArchivo(a.carta),simpleScript.reloadGrid("#"+diccionario.tabs.VCOTI+"gridVGenerarCotizacion"));simpleScript.closeModal("#"+diccionario.tabs.T4+"formViewMensaje")}})}; this.publico.getFormMigrarCotizacion=function(a,b){c=b;simpleAjax.send({element:a,dataType:"html",root:"ventas/generarCotizacion/getFormMigrarCotizacion",data:"&_idCotizacion="+c,fnCallback:function(a){$("#cont-modal").append(a);$("#"+diccionario.tabs.VCOTI+"formMigrarCotizacion").modal("show")}})};this.publico.postMigrarCotizacion=function(){simpleAjax.send({element:"#"+diccionario.tabs.VCOTI+"btnEdMigrar",root:"ventas/generarCotizacion/postMigrarCotizacion",form:"#"+diccionario.tabs.VCOTI+"formMigrarCotizacion", data:"&_idCotizacion="+c,clear:!0,fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)||simpleScript.notify.ok({content:lang.mensajes.MSG_19,callback:function(){simpleScript.closeModal("#"+diccionario.tabs.VCOTI+"formMigrarCotizacion");simpleScript.reloadGrid("#"+diccionario.tabs.VCOTI+"gridVGenerarCotizacion")}})}})};return this.publico},vGenerarCotizacion=new vGenerarCotizacion_;