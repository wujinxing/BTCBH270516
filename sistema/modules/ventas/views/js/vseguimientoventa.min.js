var vseguimientoventa_=function(){var c,d,e;d=c=0;e="";this.publico={};this.publico.main=function(a){simpleScript.addTab({id:diccionario.tabs.VSEVE,label:$(a).attr("title"),fnCallback:function(){e=$(a).data("sitemap");vseguimientoventa.getContenido()}})};this.publico.getContenido=function(){simpleAjax.send({dataType:"html",root:"ventas/vseguimientoventa/",data:"&_siteMap="+e,fnCallback:function(a){$("#"+diccionario.tabs.VSEVE+"_CONTAINER").html(a);vseguimientoventa.getGridVseguimientoventa()}})}; this.publico.getGridVseguimientoventa=function(){var a=$("#"+diccionario.tabs.VSEVE+"gridVseguimientoventa").dataTable({bProcessing:!0,bServerSide:!0,bDestroy:!0,sPaginationType:"bootstrap_full",sServerMethod:"POST",bPaginate:!0,iDisplayLength:10,aoColumns:[{sTitle:lang.generico.CODIGO,sWidth:"10%"},{sTitle:lang.generico.CLIENTE,sWidth:"30%"},{sTitle:lang.generico.SUCURSAL,sWidth:"8%"},{sTitle:lang.generico.FECHA,sWidth:"10%",sClass:"center"},{sTitle:lang.generico.TOTAL,sWidth:"13%",sClass:"right"}, {sTitle:lang.generico.SALDO,sWidth:"13%",sClass:"right"},{sTitle:lang.generico.ESTADO,sWidth:"8%",sClass:"center"},{sTitle:lang.generico.ACCIONES,sWidth:"15%",sClass:"center",bSortable:!1}],aaSorting:[[0,"desc"]],sScrollY:"350px",sAjaxSource:"ventas/vseguimientoventa/getGridVseguimientoventa",fnServerParams:function(a){a.push({name:"_idSucursalGrid",value:$("#"+diccionario.tabs.VSEVE+"lst_sucursalGrid").val()})},fnDrawCallback:function(){$("#"+diccionario.tabs.VSEVE+"gridVseguimientoventa_filter").find("input").attr("placeholder", lang.busqueda.VSEVE).css("width","250px");simpleScript.enterSearch("#"+diccionario.tabs.VSEVE+"gridVseguimientoventa",a);simpleScript.removeAttr.click({container:"#widget_"+diccionario.tabs.VSEVE,typeElement:"button"})}});setup_widgets_desktop()};this.publico.getIndexPago=function(a,b){c=b;simpleAjax.send({element:a,dataType:"html",root:"ventas/vseguimientoventa/getFormIndexPagoVenta",data:"&_idVenta="+c,fnCallback:function(a){$("#cont-modal").append(a);$("#"+diccionario.tabs.VSEVE+"formIndexPagoVenta").modal("show"); setTimeout(function(){vseguimientoventa.getGridPagoVenta()},500);$("#"+diccionario.tabs.VSEVE+"formIndexPagoVenta .scroll-form").css("height","auto")}})};this.publico.getGridPagoVenta=function(){var a=$("#"+diccionario.tabs.VSEVE+"gridPagoVenta").dataTable({bFilter:!1,sSearch:!1,bProcessing:!0,bServerSide:!0,bDestroy:!0,sPaginationType:"bootstrap_full",sServerMethod:"POST",bPaginate:!0,iDisplayLength:10,aoColumns:[{sTitle:lang.generico.NRO,sWidth:"1%",bSortable:!1},{sTitle:lang.generico.FECHA,sWidth:"20%", sClass:"center"},{sTitle:lang.generico.METODOPAGO,sWidth:"10%",sClass:"center"},{sTitle:lang.generico.TOTAL,sWidth:"25%",sClass:"right"},{sTitle:lang.generico.ESTADO,sWidth:"15%",sClass:"center"},{sTitle:lang.generico.ACCIONES,sWidth:"10%",sClass:"center",bSortable:!1}],aaSorting:[[1,"asc"]],sScrollY:"200px",sAjaxSource:"ventas/vseguimientoventa/getGridPagoVenta",fnServerParams:function(a){a.push({name:"_idVenta",value:c})},fnDrawCallback:function(){$("#"+diccionario.tabs.VSEVE+"gridPagoVenta_filter").find("input").attr("placeholder", "Buscar por Serie o Numero").css("width","200px").css("height","28px");simpleScript.enterSearch("#"+diccionario.tabs.VSEVE+"gridPagoVenta",a);simpleScript.removeAttr.click({container:"#"+diccionario.tabs.VSEVE+"formIndexPagoVenta",typeElement:"button"});$("#"+diccionario.tabs.VSEVE+"gridPagoVenta_info").css("margin-left","10px");$("#"+diccionario.tabs.VSEVE+"gridPagoVenta_wrapper .dataTables_paginate").css("margin-right","10px");$("#"+diccionario.tabs.VSEVE+"pagoVenta_refresh").css("padding","5px 10px")}}); setup_widgets_desktop()};this.publico.getFormPagarVenta=function(a,b){c=b;d=$("#"+diccionario.tabs.VSEVE+"txt_saldo").val();simpleAjax.send({element:a,dataType:"html",root:"ventas/vseguimientoventa/getFormPagarVenta",data:"&_idVenta="+c+"&_saldo="+d,fnCallback:function(a){$("#cont-modal").append(a);$("#"+diccionario.tabs.VSEVE+"formNewPagarVenta").modal("show")}})};this.publico.postPagoVenta=function(){if(0>=parseFloat($("#"+diccionario.tabs.VSEVE+"txt_pago").val()))return simpleScript.notify.warning({content:"Monto a pagar no puede ser igual o menor a CERO."}), !1;simpleAjax.send({element:"#"+diccionario.tabs.VSEVE+"btnGrVseguimientoventa",root:"ventas/vseguimientoventa/postPagarVenta",form:"#"+diccionario.tabs.VSEVE+"formNewPagarVenta",data:"&_idVenta="+c,fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)?isNaN(a.result)||2!==parseInt(a.result)?isNaN(a.result)||3!==parseInt(a.result)||simpleScript.notify.error({content:"Monto es mayor que el saldo: S/ "+globalScript.number_format(a.saldo,2)}):simpleScript.notify.error({content:"No existe saldo para registrar pago."}): simpleScript.notify.ok({content:lang.mensajes.MSG_3,callback:function(){simpleScript.reloadGrid("#"+diccionario.tabs.VSEVE+"gridPagoVenta");$("#"+diccionario.tabs.VSEVE+"txt_saldo").val(simpleScript.deleteComa(a.saldo));0==a.saldo&&$("#"+diccionario.tabs.VSEVE+"btnNewPagoVenta").attr("disabled","disabled");$("#"+diccionario.tabs.VSEVE+"saldo_pago").html("S/ "+globalScript.number_format(a.saldo,2));0<$("#"+diccionario.tabs.VSEVE+"_CONTAINER").length&&setTimeout(function(){simpleScript.reloadGrid("#"+ diccionario.tabs.VSEVE+"gridVseguimientoventa")},500);0<$("#"+diccionario.tabs.VGEVE+"_CONTAINER").length&&setTimeout(function(){simpleScript.reloadGrid("#"+diccionario.tabs.VGEVE+"gridGenerarVenta")},1E3);simpleScript.closeModal("#"+diccionario.tabs.VSEVE+"formNewPagarVenta")}})}})};this.publico.postPDF=function(a,b){simpleAjax.send({element:a,root:"ventas/vseguimientoventa/postPDF",data:"&_idVenta="+b,fnCallback:function(a){1===parseInt(a.result)&&($("#"+diccionario.tabs.VSEVE+"btnDowPDF").off("click"), $("#"+diccionario.tabs.VSEVE+"btnDowPDF").attr("onclick","window.open('public/files/"+a.archivo+"','_blank');"),$("#"+diccionario.tabs.VSEVE+"btnDowPDF").click())}})};this.publico.postAnularPago=function(a,b){simpleScript.notify.confirm({content:lang.mensajes.MSG_13,callbackSI:function(){simpleAjax.send({element:a,data:"&_idPago="+b,root:"ventas/vseguimientoventa/postAnularPago",fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)?isNaN(a.result)||2!==parseInt(a.result)||simpleScript.notify.error({content:lang.mensajes.MSG_43}): simpleScript.notify.ok({content:lang.mensajes.MSG_17,callback:function(){$("#"+diccionario.tabs.VSEVE+"saldo_pago").html("S/ "+globalScript.number_format(a.saldo,2));simpleScript.reloadGrid("#"+diccionario.tabs.VSEVE+"gridPagoVenta");$("#"+diccionario.tabs.VSEVE+"txt_saldo").val(simpleScript.deleteComa(a.saldo));0!==a.saldo&&$("#"+diccionario.tabs.VSEVE+"btnNewPagoVenta").removeAttr("disabled");0<$("#"+diccionario.tabs.VSEVE+"_CONTAINER").length&&setTimeout(function(){simpleScript.reloadGrid("#"+ diccionario.tabs.VSEVE+"gridVseguimientoventa")},500);0<$("#"+diccionario.tabs.VGEVE+"_CONTAINER").length&&setTimeout(function(){simpleScript.reloadGrid("#"+diccionario.tabs.VGEVE+"gridGenerarVenta")},1E3)}})}})}})};this.publico.postEditarGenerarVenta=function(a,b){simpleScript.notify.confirm({content:lang.mensajes.MSG_44,callbackSI:function(){simpleAjax.send({element:a,data:"&_idVenta="+b,root:"ventas/vseguimientoventa/postModificarGenerarVenta",fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)|| simpleScript.notify.ok({content:lang.mensajes.MSG_45,callback:function(){simpleScript.reloadGrid("#"+diccionario.tabs.VSEVE+"gridVseguimientoventa")}})}})}})};return this.publico},vseguimientoventa=new vseguimientoventa_;