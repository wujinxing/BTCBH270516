var modificarVenta_=function(){var b,c;b=0;c="";this.publico={};this.publico.main=function(a){simpleScript.addTab({id:diccionario.tabs.VMOVE,label:$(a).attr("title"),fnCallback:function(){c=$(a).data("sitemap");modificarVenta.getContenido()}})};this.publico.getContenido=function(){simpleAjax.send({dataType:"html",root:"ventas/modificarVenta/",data:"&_siteMap="+c,fnCallback:function(a){$("#"+diccionario.tabs.VMOVE+"_CONTAINER").html(a);modificarVenta.getGridModificarVenta()}})};this.publico.getGridModificarVenta= function(){var a=$("#"+diccionario.tabs.VMOVE+"gridModificarVenta").dataTable({bProcessing:!0,bServerSide:!0,bDestroy:!0,sPaginationType:"bootstrap_full",sServerMethod:"POST",bPaginate:!0,iDisplayLength:10,aoColumns:[{sTitle:lang.generico.CODIGO,sWidth:"8%"},{sTitle:lang.generico.CLIENTE,sWidth:"20%"},{sTitle:lang.generico.SUCURSAL,sWidth:"10%"},{sTitle:lang.generico.FECHA,sWidth:"10%",sClass:"center"},{sTitle:lang.generico.TOTAL,sWidth:"11%",sClass:"right"},{sTitle:lang.generico.PAGADO,sWidth:"11%", sClass:"right"},{sTitle:lang.generico.SALDO,sWidth:"11%",sClass:"right"},{sTitle:lang.generico.ESTADO,sWidth:"8%",sClass:"center"},{sTitle:lang.generico.ACCIONES,sWidth:"15%",sClass:"center",bSortable:!1}],aaSorting:[[0,"desc"]],sScrollY:"300px",sAjaxSource:"ventas/modificarVenta/getGridModificarVenta",fnServerParams:function(a){a.push({name:"_idSucursalGrid",value:$("#"+diccionario.tabs.VMOVE+"lst_sucursalGrid").val()})},fnDrawCallback:function(){$("#"+diccionario.tabs.VMOVE+"gridModificarVenta_filter").find("input").attr("placeholder", lang.busqueda.VMOVE).css("width","250px");simpleScript.enterSearch("#"+diccionario.tabs.VMOVE+"gridModificarVenta",a);simpleScript.removeAttr.click({container:"#widget_"+diccionario.tabs.VMOVE,typeElement:"button"})}});setup_widgets_desktop()};this.publico.postPDF=function(a,b){simpleAjax.send({element:a,root:"ventas/modificarVenta/postPDF",data:"&_idVenta="+b,fnCallback:function(a){1===parseInt(a.result)&&($("#"+diccionario.tabs.VMOVE+"btnDowPDF").off("click"),$("#"+diccionario.tabs.VMOVE+"btnDowPDF").attr("onclick", "window.open('public/files/"+a.archivo+"','_blank');"),$("#"+diccionario.tabs.VMOVE+"btnDowPDF").click())}})};this.publico.getFormEditVenta=function(a,d){b=d;0<$("#"+diccionario.tabs.VGEVE+"new_CONTAINER").length?simpleScript.notify.warning({content:"La pesta\u00f1a de Nueva o Editar o Procesar Venta se encuentra abierta, debe cerrarla para realizar este proceso."}):(generarVentaScript.resetArrayProducto(),simpleScript.addTab({id:diccionario.tabs.VGEVE+"new",label:"Editar Venta",fnCallback:function(){modificarVenta.getContEditVenta(a)}}))}; this.publico.getContEditVenta=function(a){simpleAjax.send({element:a,dataType:"html",root:"ventas/modificarVenta/getFormEditVenta",data:"&_idVenta="+b,fnCallback:function(a){$("#"+diccionario.tabs.VGEVE+"new_CONTAINER").html(a)}})};this.publico.getFormCancelarVenta=function(a,c){b=c;simpleAjax.send({element:a,dataType:"html",root:"ventas/modificarVenta/getFormCancelarVenta",data:"&_idVenta="+b,fnCallback:function(a){$("#cont-modal").append(a);$("#"+diccionario.tabs.VMOVE+"formCancelarVenta").modal("show")}})}; this.publico.postEditarGenerarVenta=function(){simpleScript.notify.confirm({content:lang.mensajes.MSG_46,callbackSI:function(){simpleAjax.send({element:"#"+diccionario.tabs.VMOVE+"btnEdVenta",root:"ventas/modificarVenta/postModificarVenta",form:"#"+diccionario.tabs.VMOVE+"formEditGenerarVenta",data:"&_idVenta="+b,fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)?isNaN(a.result)||2!==parseInt(a.result)?isNaN(a.result)||3!==parseInt(a.result)||simpleScript.notify.error({content:"El pago inicial + el pago anterior, es mayor que el total a pagar. Por favor verificar."}): simpleScript.notify.error({content:"No existe caja. Por favor revisar."}):simpleScript.notify.ok({content:lang.mensajes.MSG_3,callback:function(){simpleScript.closeTab(diccionario.tabs.VGEVE+"new");simpleScript.reloadGrid("#"+diccionario.tabs.VMOVE+"gridModificarVenta");b=0;0<$("#"+diccionario.tabs.VGEVE+"_CONTAINER").length&&simpleScript.asyncJs({fn:function(){simpleScript.reloadGrid("#"+diccionario.tabs.VGEVE+"gridGenerarVenta")},tiempo:1500})}})}})}})};this.publico.postCancelarVenta=function(){simpleScript.notify.confirm({content:lang.mensajes.MSG_44, callbackSI:function(){simpleAjax.send({element:"#"+diccionario.tabs.VMOVE+"btnInVenta",root:"ventas/modificarVenta/postCancelarVenta",form:"#"+diccionario.tabs.VMOVE+"formCancelarVenta",data:"&_idVenta="+b,fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)?isNaN(a.result)||2!==parseInt(a.result)||simpleScript.notify.error({content:"No existe caja. Por favor revisar."}):simpleScript.notify.ok({content:lang.mensajes.MSG_3,callback:function(){simpleScript.closeModal("#"+diccionario.tabs.VMOVE+ "formCancelarVenta");simpleScript.reloadGrid("#"+diccionario.tabs.VMOVE+"gridModificarVenta");b=0;0<$("#"+diccionario.tabs.VGEVE+"_CONTAINER").length&&simpleScript.asyncJs({fn:function(){simpleScript.reloadGrid("#"+diccionario.tabs.VGEVE+"gridGenerarVenta")},tiempo:1500})}})}})}})};return this.publico},modificarVenta=new modificarVenta_;