var cajaCierre_=function(){var b;b=0;this.publico={};this.publico.main=function(a){simpleScript.addTab({id:diccionario.tabs.CAJAC,label:$(a).attr("title"),fnCallback:function(){cajaCierre.getContenido()}})};this.publico.getContenido=function(){simpleAjax.send({dataType:"html",root:"ventas/cajaCierre/",fnCallback:function(a){$("#"+diccionario.tabs.CAJAC+"_CONTAINER").html(a);cajaCierre.getGridCajaCierre()}})};this.publico.getGridCajaCierre=function(){$("#"+diccionario.tabs.CAJAC+"gridCajaCierre").dataTable({bFilter:!1, bProcessing:!0,bServerSide:!0,bDestroy:!0,sPaginationType:"bootstrap_full",sServerMethod:"POST",bPaginate:!0,iDisplayLength:10,aoColumns:[{sTitle:lang.generico.ID,sWidth:"2%"},{sTitle:lang.generico.FECHAHORA,sWidth:"15%"},{sTitle:lang.generico.SUCURSAL,sWidth:"8%",sClass:"center"},{sTitle:lang.generico.MONEDA,sWidth:"3%",sClass:"center"},{sTitle:lang.generico.INICIAL,sWidth:"10%",sClass:"right"},{sTitle:lang.generico.INGRESOS,sWidth:"10%",sClass:"right"},{sTitle:lang.generico.EGRESOS,sWidth:"10%", sClass:"right"},{sTitle:lang.generico.SALDO,sWidth:"10%",sClass:"right"},{sTitle:lang.generico.ESTADO,sWidth:"10%",sClass:"center"},{sTitle:lang.generico.ACCIONES,sWidth:"12%",sClass:"center",bSortable:!1}],aaSorting:[[0,"desc"]],sScrollY:"300px",sAjaxSource:"ventas/cajaCierre/getGridCajaCierre",fnServerParams:function(a){a.push({name:"_fecha1",value:$("#"+diccionario.tabs.CAJAC+"txt_f1").val()});a.push({name:"_fecha2",value:$("#"+diccionario.tabs.CAJAC+"txt_f2").val()});a.push({name:"_idSucursalGrid", value:$("#"+diccionario.tabs.CAJAC+"lst_sucursalGrid").val()})},fnDrawCallback:function(){simpleScript.removeAttr.click({container:"#widget_"+diccionario.tabs.CAJAC,typeElement:"button"})}});setup_widgets_desktop()};this.publico.getFormNewCierre=function(a,c){b=c;simpleScript.addTab({id:diccionario.tabs.CAJAC+"new",label:lang.caja.NEWCIERRE,fnCallback:function(){cajaCierre.getContCierre(a)}})};this.publico.getContCierre=function(a){simpleAjax.send({dataType:"html",element:a,data:"&_idCajaCierre="+ b,root:"ventas/cajaCierre/getFormNewCierre",fnCallback:function(a){$("#"+diccionario.tabs.CAJAC+"new_CONTAINER").html(a)}})};this.publico.postGenerarCierre=function(){simpleScript.notify.confirm({content:lang.mensajes.MSG_21,callbackSI:function(){simpleAjax.send({element:"#"+diccionario.tabs.CAJAC+"btnGrCierre",root:"ventas/cajaCierre/postGenerarCierre",form:"#"+diccionario.tabs.CAJAC+"formNewCierre",data:"&_idCajaCierre="+b,fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)?isNaN(a.result)|| 2!==parseInt(a.result)?isNaN(a.result)||3!==parseInt(a.result)||(simpleScript.notify.warning({content:"La caja ya se encuentra cerrada, ya no se puede realizar este proceso."}),simpleScript.reloadGrid("#"+diccionario.tabs.CAJAC+"gridCajaCierre"),simpleScript.asyncJs({fn:function(){$("#btnCaja"+a.idCaja).click()},tiempo:1E3})):simpleScript.notify.error({content:"No existe caja. Por favor revisar."}):simpleScript.notify.ok({content:lang.mensajes.MSG_3,callback:function(){simpleScript.closeTab(diccionario.tabs.CAJAC+ "new");0<$("#"+diccionario.tabs.VGEVE+"_CONTAINER").length&&simpleScript.closeTab(diccionario.tabs.VGEVE);0<$("#"+diccionario.tabs.VGEVE+"cotizacion_CONTAINER").length&&simpleScript.closeTab(diccionario.tabs.VGEVE+"cotizacion");0<$("#"+diccionario.tabs.VGEVE+"new_CONTAINER").length&&simpleScript.closeTab(diccionario.tabs.VGEVE+"new");0<$("#"+diccionario.tabs.VGEVE+"edit_CONTAINER").length&&simpleScript.closeTab(diccionario.tabs.VGEVE+"edit");0<$("#"+diccionario.tabs.VSEVE+"_CONTAINER").length&&simpleScript.closeTab(diccionario.tabs.VSEVE); 0<$("#"+diccionario.tabs.VEGRE+"_CONTAINER").length&&simpleScript.closeTab(diccionario.tabs.VEGRE);simpleScript.reloadGrid("#"+diccionario.tabs.CAJAC+"gridCajaCierre");simpleScript.asyncJs({fn:function(){$("#btnCaja"+a.idCaja).click()},tiempo:1E3});b=0}})}})}})};this.publico.postPDF=function(a,b){simpleAjax.send({element:a,root:"ventas/cajaCierre/postPDF",data:"&_idCajaCierre="+b,fnCallback:function(a){1===parseInt(a.result)&&($("#"+diccionario.tabs.CAJAC+"btnDowPDF").off("click"),$("#"+diccionario.tabs.CAJAC+ "btnDowPDF").attr("onclick","window.open('public/files/"+a.archivo+"','_blank');"),$("#"+diccionario.tabs.CAJAC+"btnDowPDF").click())}})};this.publico.postExcel=function(a,b){simpleAjax.send({element:a,root:"ventas/cajaCierre/postExcel",data:"&_idCajaCierre="+b,fnCallback:function(a){1===parseInt(a.result)&&($("#"+diccionario.tabs.CAJAC+"btnDowExcel").off("click"),$("#"+diccionario.tabs.CAJAC+"btnDowExcel").attr("onclick","window.open('public/files/"+a.archivo+"','_self');"),$("#"+diccionario.tabs.CAJAC+ "btnDowExcel").click());isNaN(a.result)||2!==parseInt(a.result)||simpleScript.notify.error({content:"Ocurri\u00f3 un error al exportar Venta."})}})};return this.publico},cajaCierre=new cajaCierre_;