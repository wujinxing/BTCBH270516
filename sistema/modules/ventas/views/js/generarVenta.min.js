var generarVenta_=function(){var d,c,e;c=d=0;e="";this.publico={};this.publico.main=function(a){simpleScript.addTab({id:diccionario.tabs.VGEVE,label:$(a).attr("title"),fnCallback:function(){e=$(a).data("sitemap");generarVenta.getContenido()}})};this.publico.getContenido=function(){simpleAjax.send({dataType:"html",root:"ventas/generarVenta/",data:"&_siteMap="+e,fnCallback:function(a){$("#"+diccionario.tabs.VGEVE+"_CONTAINER").html(a);generarVenta.getGridGenerarVenta()}})};this.publico.getGridGenerarVenta= function(){var a=$("#"+diccionario.tabs.VGEVE+"gridGenerarVenta").dataTable({bProcessing:!0,bServerSide:!0,bDestroy:!0,sPaginationType:"bootstrap_full",sServerMethod:"POST",bPaginate:!0,iDisplayLength:10,aoColumns:[{sTitle:lang.generico.CODIGO,sWidth:"8%"},{sTitle:lang.generico.CLIENTE,sWidth:"25%"},{sTitle:lang.generico.SUCURSAL,sWidth:"8%"},{sTitle:lang.generico.FECHA,sWidth:"10%",sClass:"center"},{sTitle:lang.generico.TOTAL,sWidth:"13%",sClass:"right"},{sTitle:lang.generico.SALDO,sWidth:"13%", sClass:"right"},{sTitle:lang.generico.ESTADO,sWidth:"10%",sClass:"center"},{sTitle:lang.generico.ACCIONES,sWidth:"20%",sClass:"center",bSortable:!1}],aaSorting:[[0,"desc"]],sScrollY:"350px",sAjaxSource:"ventas/generarVenta/getGridGenerarVenta",fnServerParams:function(a){a.push({name:"_fecha1",value:$("#"+diccionario.tabs.VGEVE+"txt_f1").val()});a.push({name:"_fecha2",value:$("#"+diccionario.tabs.VGEVE+"txt_f2").val()});a.push({name:"_idSucursalGrid",value:$("#"+diccionario.tabs.VGEVE+"lst_sucursalGrid").val()})}, fnDrawCallback:function(){$("#"+diccionario.tabs.VGEVE+"gridGenerarVenta_filter").find("input").attr("placeholder",lang.busqueda.VGEVE).css("width","200px");simpleScript.enterSearch("#"+diccionario.tabs.VGEVE+"gridGenerarVenta",a);simpleScript.removeAttr.click({container:"#widget_"+diccionario.tabs.VGEVE,typeElement:"button"})}});setup_widgets_desktop()};this.publico.getFormBuscarProductos=function(a,b){simpleAjax.send({element:a,dataType:"html",root:"ventas/generarVenta/getFormBuscarProductos",fnCallback:function(a){$("#cont-modal").append(a); $("#"+diccionario.tabs.VGEVE+"formBuscarProductos").modal("show")}})};this.publico.getFormNewIngresoDirecto=function(a){simpleAjax.send({element:a,dataType:"html",root:"ventas/generarVenta/getFormNewIngresoDirecto",fnCallback:function(a){$("#cont-modal").append(a);$("#"+diccionario.tabs.VGEVE+"formNewIngresoDirecto").modal("show")}})};this.publico.getFormNewGenerarVenta=function(a){0<$("#"+diccionario.tabs.VGEVE+"new_CONTAINER").length?simpleScript.notify.warning({content:"La pesta\u00f1a de Nueva o Editar o Procesar Venta se encuentra abierta, debe cerrarla para realizar este proceso."}): (generarVentaScript.resetArrayProducto(),simpleScript.addTab({id:diccionario.tabs.VGEVE+"new",label:"Nueva Venta",fnCallback:function(){generarVenta.getContGenerarVenta()}}))};this.publico.getContGenerarVenta=function(){simpleAjax.send({dataType:"html",root:"ventas/generarVenta/getFormNewGenerarVenta",fnCallback:function(a){$("#"+diccionario.tabs.VGEVE+"new_CONTAINER").html(a)}})};this.publico.getFormProcesarGenerarVenta=function(a,b){c=b;0<$("#"+diccionario.tabs.VGEVE+"new_CONTAINER").length?simpleScript.notify.warning({content:"La pesta\u00f1a de Nueva o Editar o Procesar Venta se encuentra abierta, debe cerrarla para realizar este proceso."}): (generarVentaScript.resetArrayProducto(),simpleScript.addTab({id:diccionario.tabs.VGEVE+"new",label:"Nueva Venta - Cotizaci\u00f3n",fnCallback:function(){generarVenta.getContProcesarVenta(a)}}))};this.publico.getContProcesarVenta=function(a){simpleAjax.send({element:a,dataType:"html",root:"ventas/generarVenta/getFormProcesarGenerarVenta",data:"&_idCotizacion="+c,fnCallback:function(a){$("#"+diccionario.tabs.VGEVE+"new_CONTAINER").html(a)}})};this.publico.postNewGenerarVenta=function(){simpleAjax.send({element:"#"+ diccionario.tabs.VGEVE+"btnGrVenta",root:"ventas/generarVenta/postNewGenerarVenta",form:"#"+diccionario.tabs.VGEVE+"formNewGenerarVenta",data:"&_idVenta="+d+"&_idCotizacion="+c,fnCallback:function(a){isNaN(a.result)||1!==parseInt(a.result)?isNaN(a.result)||2!==parseInt(a.result)||simpleScript.notify.error({content:"No existe caja. Por favor revisar."}):simpleScript.notify.ok({content:lang.mensajes.MSG_3,callback:function(){simpleScript.closeTab(diccionario.tabs.VGEVE+"new");0<$("#"+diccionario.tabs.VCOTI+ "_CONTAINER").length&&simpleScript.asyncJs({fn:function(){simpleScript.reloadGrid("#"+diccionario.tabs.VCOTI+"gridVGenerarCotizacion")},tiempo:1500});simpleScript.reloadGrid("#"+diccionario.tabs.VGEVE+"gridGenerarVenta");c=d=0}})}})};this.publico.postNewIngresoDirecto=function(){simpleAjax.send({element:"#"+diccionario.tabs.VGEVE+"btnGrIngresoDirecto",root:"ventas/generarVenta/postNewIngresoDirecto",form:"#"+diccionario.tabs.VGEVE+"formNewIngresoDirecto",fnCallback:function(a){isNaN(a.result)||1!== parseInt(a.result)?isNaN(a.result)||2!==parseInt(a.result)||simpleScript.notify.error({content:"No existe caja. Por favor revisar."}):(simpleScript.notify.ok({content:lang.mensajes.MSG_3}),simpleScript.reloadGrid("#"+diccionario.tabs.VGEVE+"gridGenerarVenta"),simpleScript.closeModal("#"+diccionario.tabs.VGEVE+"formNewIngresoDirecto"))}})};this.publico.postPDF=function(a,b){simpleAjax.send({element:a,root:"ventas/generarVenta/postPDF",data:"&_idVenta="+b,fnCallback:function(a){1===parseInt(a.result)&& ($("#"+diccionario.tabs.VGEVE+"btnDowPDF").off("click"),$("#"+diccionario.tabs.VGEVE+"btnDowPDF").attr("onclick","window.open('public/files/"+a.archivo+"','_blank');"),$("#"+diccionario.tabs.VGEVE+"btnDowPDF").click())}})};this.publico.postExcel=function(a,b){simpleAjax.send({element:a,root:"ventas/generarVenta/postExcel",data:"&_idVenta="+b,fnCallback:function(a){1===parseInt(a.result)&&($("#"+diccionario.tabs.VGEVE+"btnDowExcel").off("click"),$("#"+diccionario.tabs.VGEVE+"btnDowExcel").attr("onclick", "window.open('public/files/"+a.archivo+"','_self');"),$("#"+diccionario.tabs.VGEVE+"btnDowExcel").click());isNaN(a.result)||2!==parseInt(a.result)||simpleScript.notify.error({content:"Ocurri\u00f3 un error al exportar Venta."})}})};this.publico.postAnularGenerarVenta=function(a,b){simpleScript.notify.confirm({content:lang.mensajes.MSG_13,callbackSI:function(){simpleAjax.send({element:a,data:"&_idVenta="+b,root:"ventas/generarVenta/postAnularGenerarVenta",fnCallback:function(a){isNaN(a.result)||1!== parseInt(a.result)||simpleScript.notify.ok({content:lang.mensajes.MSG_17,callback:function(){simpleScript.reloadGrid("#"+diccionario.tabs.VGEVE+"gridGenerarVenta")}})}})}})};return this.publico},generarVenta=new generarVenta_;