var vGenerarCotizacionScript_=function(){var g,k,d;g=[];d=k=0;this.publico={};this.publico.addProducto=function(){simpleScript.validaCheckBox({id:"#"+diccionario.tabs.VCOTI+"gridProductosFound",msn:lang.mensajes.MSG_9,fnCallback:function(){var l=$("#"+diccionario.tabs.VCOTI+"gridProductosFound").find("tbody").find("tr"),h,b,c,e,g,d,k,a="",m=0,f=0;$.each(l,function(l,n){h=$(this).find("td:eq(1)").find("input:checkbox");h.is(":checked")&&(b=h.val().split("~"),c=b[0],e=b[1],g=parseFloat(b[2]).toFixed(2), d=b[3],k=b[4],m=g,vGenerarCotizacionScript.setIndex(),f=vGenerarCotizacionScript.getIndex(),a+='<tr id="'+diccionario.tabs.VCOTI+"tr_"+f+'">',a+="    <td>",a+='        <input type="hidden" id="'+diccionario.tabs.VCOTI+f+'hhddIdProducto" name="'+diccionario.tabs.VCOTI+'hhddIdProducto[]" value="'+c+'">',a+='         <label class="textarea">',a=201600000001==simpleAjax.stringGet(c)?a+('<textarea class="editable" style="height:120px; resize: vertical;" autocomplete="on" id="'+diccionario.tabs.VCOTI+f+ 'txt_descripcion" name="'+diccionario.tabs.VCOTI+'txt_descripcion[]" ></textarea>'):a+('<textarea style="background:#EFEFEF;" autocomplete="on" disabled id="'+diccionario.tabs.VCOTI+f+'txt_descripcion" name="'+diccionario.tabs.VCOTI+'txt_descripcion[]" >'+e+"</textarea>"),a+="</label>",a+="    </td>",a+="    <td>"+d+"</td>",a+="    <td>",a+='        <label class="input"><input type="text" id="'+diccionario.tabs.VCOTI+f+'txt_cantidad1" name="'+diccionario.tabs.VCOTI+'txt_cantidad1[]" value="1" style="text-align:right" data-index="'+ f+'"></label></td>',"0"==k?(a+="<td>",a+='        <label class="input"><input style="background:#EFEFEF;text-align:right;" type="text" id="'+diccionario.tabs.VCOTI+f+'txt_cantidad2" name="'+diccionario.tabs.VCOTI+'txt_cantidad2[]" value="1" style="text-align:right" data-index="'+f+'" readonly></label>'):(a+="<td>",a+='        <label class="input"><input type="text" id="'+diccionario.tabs.VCOTI+f+'txt_cantidad2" name="'+diccionario.tabs.VCOTI+'txt_cantidad2[]" value="1" style="text-align:right" data-index="'+ f+'"></label>'),a+="    </td>",a+='<td class="right">1.00</td>',a+='    <td class="right">',a+='        <label class="input"><input type="text" id="'+diccionario.tabs.VCOTI+f+'txt_precio" name="'+diccionario.tabs.VCOTI+'txt_precio[]" value="'+g+'" data-value="'+g+'" data-index="'+f+'" style="text-align:right"></label>',a+="    </td>",a+='    <td class="right">'+parseFloat(m).toFixed(2)+"</td>",a+="    <td>",a+='        <button type="button" class="btn btn-danger btn-xs" onclick="vGenerarCotizacionScript.removeItem(\''+ f+'\');"><i class="fa fa-trash-o"></i></a>',a+="    </td>",a+="</tr>")});""!==a&&($("#"+diccionario.tabs.VCOTI+"gridProductos").find("tbody").append(a),simpleScript.closeModal("#"+diccionario.tabs.VCOTI+"formBuscarProductos"),vGenerarCotizacionScript.calculoTotal(),vGenerarCotizacionScript.calculoTotalFilaUp(),$(".editable").summernote({height:100,focus:!0,lang:"es-ES",toolbar:[["font",["bold","italic","underline","clear","codeview"]]]}))}});simpleScript.removeAttr.click({container:"#"+diccionario.tabs.VCOTI+ "gridProductos",typeElement:"button"})};this.publico.removeItem=function(d){for(var h in g)g[h]===d&&(g[h]=null);$("#"+diccionario.tabs.VCOTI+"tr_"+d).remove();vGenerarCotizacionScript.calculoTotal()};this.publico.getIndex=function(){return d};this.publico.setIndex=function(){d+=1;g.push(d)};this.publico.calculoTotal=function(){var d=$("#"+diccionario.tabs.VCOTI+"gridProductos").find("tbody").find("tr"),h=0;$.each(d,function(){var b=simpleScript.deleteComa($.trim($(this).find("td:eq(6)").text())); 0<b.length&&(h+=parseFloat(b))});k=h;$("#"+diccionario.tabs.VCOTI+"txt_total").val(k.toFixed(2))};this.publico.calculoTotalFilaUp=function(){var d=$("#"+diccionario.tabs.VCOTI+"gridProductos").find("tbody").find("tr");$.each(d,function(){var d=$(this);$(this).find("td:eq(2)").find("input:text").keyup(function(){(isNaN($(this).val())||0>$(this).val()||""==$(this).val())&&$(this).val(1);var b=$(this).attr("data-index"),c=$(this).val(),e=simpleScript.deleteComa($("#"+diccionario.tabs.VCOTI+b+"txt_cantidad2").val()), b=simpleScript.deleteComa($("#"+diccionario.tabs.VCOTI+b+"txt_precio").val()),c=c.replace(",",""),e=e.replace(",",""),c=parseFloat(c)*parseFloat(e);d.find("td:eq(4)").html(c.toFixed(2));e=0;e=parseFloat(b)*parseFloat(c);d.find("td:eq(6)").html(e.toFixed(2));vGenerarCotizacionScript.calculoTotal()});$(this).find("td:eq(3)").find("input:text").keyup(function(){if(isNaN($(this).val())||0>$(this).val()||""==$(this).val()){var b=$(this).attr("data-value");$(this).val(b)}var b=$(this).attr("data-index"), c=$(this).val(),e=simpleScript.deleteComa($("#"+diccionario.tabs.VCOTI+b+"txt_cantidad1").val()),b=simpleScript.deleteComa($("#"+diccionario.tabs.VCOTI+b+"txt_precio").val()),c=c.replace(",",""),e=e.replace(",",""),c=parseFloat(c)*parseFloat(e),e=0,e=parseFloat(b)*parseFloat(c);d.find("td:eq(4)").html(c.toFixed(2));d.find("td:eq(6)").html(e.toFixed(2));vGenerarCotizacionScript.calculoTotal()});$(this).find("td:eq(5)").find("input:text").keyup(function(){if(isNaN($(this).val())||0>=$(this).val()|| ""==$(this).val()){var b=$(this).attr("data-value");$(this).val(b)}var c=$(this).attr("data-index"),b=$(this).val(),e=simpleScript.deleteComa($("#"+diccionario.tabs.VCOTI+c+"txt_cantidad1").val()),c=simpleScript.deleteComa($("#"+diccionario.tabs.VCOTI+c+"txt_cantidad2").val()),e=parseFloat(e)*parseFloat(c),b=b.replace(",",""),c=0,c=parseFloat(b)*parseFloat(e);d.find("td:eq(6)").html(c.toFixed(2));vGenerarCotizacionScript.calculoTotal()})})};this.publico.resetArrayProducto=function(){g=[];d=k=0};return this.publico}, vGenerarCotizacionScript=new vGenerarCotizacionScript_;